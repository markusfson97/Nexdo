<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Monly - Enkel privatekonomi</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #0a0e27 0%, #1a1f3a 100%);
      color: #e8eaf6;
      min-height: 100vh;
    }

    .monly-app {
      max-width: 480px;
      margin: 0 auto;
      padding: 20px;
      min-height: 100vh;
    }

    .start-view {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      min-height: calc(100vh - 40px);
      gap: 32px;
    }

    .logo-section {
      text-align: center;
      margin-bottom: 20px;
    }

    .logo {
      font-size: 64px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
      letter-spacing: -2px;
    }

    .tagline {
      font-size: 16px;
      color: #9fa8da;
      font-weight: 500;
    }

    .quick-actions {
      display: flex;
      flex-direction: column;
      gap: 12px;
      width: 100%;
    }

    .current-account-badge {
      background: rgba(159, 168, 218, 0.1);
      border: 2px solid rgba(159, 168, 218, 0.2);
      border-radius: 16px;
      padding: 16px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }

    .current-account-badge:hover {
      background: rgba(159, 168, 218, 0.15);
      border-color: rgba(159, 168, 218, 0.3);
      transform: translateY(-2px);
    }

    .badge-label {
      font-size: 12px;
      color: #9fa8da;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-right: 8px;
    }

    .badge-name {
      flex: 1;
      font-size: 16px;
      font-weight: 700;
      color: #e8eaf6;
    }

    .primary-button {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 16px 32px;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      transition: all 0.3s ease;
      box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
      width: 100%;
    }

    .primary-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 32px rgba(102, 126, 234, 0.5);
    }

    .secondary-button {
      background: rgba(159, 168, 218, 0.1);
      color: #9fa8da;
      border: 2px solid rgba(159, 168, 218, 0.2);
      padding: 14px 28px;
      border-radius: 14px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }

    .secondary-button:hover {
      background: rgba(159, 168, 218, 0.15);
      border-color: rgba(159, 168, 218, 0.3);
    }

    .secondary-button.small {
      padding: 8px 16px;
      font-size: 14px;
      width: auto;
    }

    .icon-button {
      background: rgba(159, 168, 218, 0.1);
      border: none;
      color: #9fa8da;
      width: 40px;
      height: 40px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .icon-button:hover {
      background: rgba(159, 168, 218, 0.2);
      transform: scale(1.05);
    }

    .icon-button.primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .icon-button.success {
      background: rgba(76, 175, 80, 0.2);
      color: #81c784;
    }

    .icon-button.danger {
      background: rgba(244, 67, 54, 0.2);
      color: #e57373;
    }

    .view-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 32px;
    }

    .view-header h2 {
      font-size: 24px;
      font-weight: 700;
      color: #e8eaf6;
    }

    .income-input-section {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 20px;
      padding: 32px;
      text-align: center;
    }

    .income-input-section label {
      display: block;
      font-size: 16px;
      font-weight: 600;
      color: #9fa8da;
      margin-bottom: 16px;
    }

    .income-input {
      width: 100%;
      background: rgba(10, 14, 39, 0.6);
      border: 2px solid rgba(159, 168, 218, 0.2);
      border-radius: 14px;
      padding: 16px;
      font-size: 28px;
      font-weight: 700;
      color: #e8eaf6;
      text-align: center;
      margin-bottom: 20px;
    }

    .income-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .income-display {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 20px;
      padding: 24px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 32px;
    }

    .income-display .label {
      font-size: 14px;
      color: #9fa8da;
      font-weight: 600;
    }

    .income-display .amount {
      font-size: 28px;
      font-weight: 800;
      color: #e8eaf6;
      flex: 1;
      text-align: center;
    }

    .edit-income-button {
      background: rgba(159, 168, 218, 0.1);
      border: none;
      color: #9fa8da;
      padding: 10px 16px;
      border-radius: 10px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 6px;
      transition: all 0.2s ease;
    }

    .edit-income-button:hover {
      background: rgba(159, 168, 218, 0.2);
    }

    .categories-grid {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .category-card {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 20px;
      padding: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .category-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
    }

    .category-card.sparande {
      border-color: rgba(76, 175, 80, 0.3);
    }

    .category-card.nojen {
      border-color: rgba(255, 152, 0, 0.3);
    }

    .category-card.fasta {
      border-color: rgba(244, 67, 54, 0.3);
    }

    .category-card h3 {
      font-size: 18px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 8px;
    }

    .category-card .percentage {
      font-size: 14px;
      color: #9fa8da;
      font-weight: 600;
      margin-bottom: 12px;
    }

    .category-card .budget-amount {
      font-size: 32px;
      font-weight: 800;
      color: #e8eaf6;
      margin-bottom: 16px;
    }

    .category-card .spent-info {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: #9fa8da;
      margin-bottom: 8px;
    }

    .category-card .spent-amount {
      font-weight: 700;
      color: #e8eaf6;
    }

    .category-card .remaining {
      display: flex;
      justify-content: space-between;
      font-size: 16px;
      font-weight: 700;
      padding-top: 12px;
      border-top: 1px solid rgba(159, 168, 218, 0.1);
    }

    .category-card .remaining.negative {
      color: #e57373;
    }

    .category-card .remaining:not(.negative) {
      color: #81c784;
    }

    .category-summary {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 32px;
    }

    .summary-item {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
    }

    .summary-item.negative {
      border-color: rgba(244, 67, 54, 0.3);
    }

    .summary-item .label {
      display: block;
      font-size: 12px;
      color: #9fa8da;
      font-weight: 600;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .summary-item .value {
      font-size: 24px;
      font-weight: 800;
      color: #e8eaf6;
    }

    .summary-item.negative .value {
      color: #e57373;
    }

    .expenses-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 32px;
    }

    .expense-item {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 14px;
      padding: 16px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .expense-name {
      flex: 1;
      font-size: 15px;
      font-weight: 600;
      color: #e8eaf6;
    }

    .expense-amount {
      font-size: 16px;
      font-weight: 700;
      color: #9fa8da;
    }

    .expense-input {
      flex: 1;
      background: rgba(10, 14, 39, 0.6);
      border: 2px solid rgba(159, 168, 218, 0.2);
      border-radius: 10px;
      padding: 10px;
      font-size: 14px;
      color: #e8eaf6;
    }

    .expense-input.amount {
      flex: 0 0 120px;
    }

    .expense-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .add-expense {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 20px;
      padding: 24px;
    }

    .add-expense h3 {
      font-size: 16px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 16px;
    }

    .add-expense-form {
      display: flex;
      gap: 12px;
    }

    .profile-menu {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .menu-button {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      font-size: 16px;
      font-weight: 600;
      color: #e8eaf6;
      transition: all 0.2s ease;
    }

    .menu-button:hover {
      background: rgba(159, 168, 218, 0.1);
      transform: translateX(4px);
    }

    .profile-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-group label {
      font-size: 14px;
      font-weight: 600;
      color: #9fa8da;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .form-input, .form-textarea {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 12px;
      padding: 14px;
      font-size: 15px;
      color: #e8eaf6;
      font-family: inherit;
    }

    .form-input:disabled, .form-textarea:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .form-input:focus, .form-textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    .history-list {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .history-item {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .history-info h3 {
      font-size: 16px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 4px;
    }

    .history-income {
      font-size: 14px;
      color: #9fa8da;
      font-weight: 600;
    }

    .history-actions {
      display: flex;
      gap: 8px;
    }

    .totals-summary {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 32px;
    }

    .total-card {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
    }

    .total-card.income {
      border-color: rgba(102, 126, 234, 0.3);
    }

    .total-card.saving {
      border-color: rgba(76, 175, 80, 0.3);
    }

    .total-card.expenses {
      border-color: rgba(244, 67, 54, 0.3);
    }

    .total-card.net {
      grid-column: 1 / -1;
      border-color: rgba(255, 193, 7, 0.3);
    }

    .total-card h3 {
      font-size: 14px;
      color: #9fa8da;
      font-weight: 600;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .total-amount {
      font-size: 28px;
      font-weight: 800;
      color: #e8eaf6;
    }

    .months-overview {
      margin-top: 32px;
    }

    .months-overview h3 {
      font-size: 18px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 16px;
    }

    .month-summary {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 12px;
    }

    .month-summary h4 {
      font-size: 16px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 12px;
    }

    .month-stats {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .stat {
      display: flex;
      justify-content: space-between;
      font-size: 14px;
      color: #e8eaf6;
    }

    .stat .label {
      color: #9fa8da;
      font-weight: 600;
    }

    .expense-category-section {
      margin-bottom: 32px;
    }

    .expense-category-section h3 {
      font-size: 18px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 16px;
    }

    .add-expense-button {
      width: 100%;
      background: rgba(102, 126, 234, 0.1);
      border: 2px dashed rgba(102, 126, 234, 0.3);
      border-radius: 14px;
      padding: 16px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      color: #667eea;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      margin-top: 12px;
    }

    .add-expense-button:hover {
      background: rgba(102, 126, 234, 0.15);
      border-color: rgba(102, 126, 234, 0.4);
      transform: translateY(-2px);
    }

    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #9fa8da;
    }

    .empty-text {
      color: #9fa8da;
      font-size: 14px;
      font-style: italic;
    }

    .account-switcher-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(10, 14, 39, 0.8);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: flex-end;
      z-index: 1000;
      animation: fadeIn 0.2s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .account-switcher {
      background: linear-gradient(135deg, #1a1f3a 0%, #0a0e27 100%);
      border-radius: 24px 24px 0 0;
      padding: 24px;
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
      animation: slideUp 0.3s ease;
    }

    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }

    .switcher-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .switcher-header h3 {
      font-size: 20px;
      font-weight: 700;
      color: #e8eaf6;
    }

    .accounts-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 20px;
    }

    .account-item {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 12px;
      padding: 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .account-item:hover {
      background: rgba(159, 168, 218, 0.1);
      transform: translateX(4px);
    }

    .account-item.active {
      border-color: rgba(102, 126, 234, 0.5);
      background: rgba(102, 126, 234, 0.1);
    }

    .account-name {
      font-size: 16px;
      font-weight: 600;
      color: #e8eaf6;
    }

    .active-badge {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      font-size: 12px;
      font-weight: 700;
    }

    .accounts-list-full {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-bottom: 20px;
    }

    .account-card {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 16px;
      padding: 20px;
    }

    .account-info {
      margin-bottom: 16px;
    }

    .account-info h3 {
      font-size: 18px;
      font-weight: 700;
      color: #e8eaf6;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .current-badge {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 11px;
      font-weight: 700;
    }

    .account-stats {
      font-size: 14px;
      color: #9fa8da;
      font-weight: 500;
    }

    .account-actions {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .account-edit-form {
      display: flex;
      gap: 12px;
      align-items: center;
    }

    .account-name-input {
      flex: 1;
      background: rgba(10, 14, 39, 0.6);
      border: 2px solid rgba(159, 168, 218, 0.2);
      border-radius: 12px;
      padding: 14px;
      font-size: 15px;
      color: #e8eaf6;
      font-family: inherit;
    }

    .account-name-input:focus {
      outline: none;
      border-color: #667eea;
    }

    .edit-actions {
      display: flex;
      gap: 8px;
    }

    .create-account-form {
      background: rgba(159, 168, 218, 0.05);
      border: 2px solid rgba(159, 168, 218, 0.1);
      border-radius: 20px;
      padding: 24px;
    }

    .create-actions {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }

    .add-account-button {
      width: 100%;
      background: rgba(102, 126, 234, 0.1);
      border: 2px dashed rgba(102, 126, 234, 0.3);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      color: #667eea;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .add-account-button:hover {
      background: rgba(102, 126, 234, 0.15);
      border-color: rgba(102, 126, 234, 0.4);
      transform: translateY(-2px);
    }

    @media (max-width: 480px) {
      .monly-app {
        padding: 16px;
      }

      .logo {
        font-size: 48px;
      }

      .category-card .budget-amount {
        font-size: 28px;
      }

      .income-display .amount {
        font-size: 24px;
      }
    }

    /* Simple icon replacements */
    .icon-calendar::before { content: "üìÖ"; }
    .icon-user::before { content: "üë§"; }
    .icon-trending::before { content: "üìà"; }
    .icon-edit::before { content: "‚úèÔ∏è"; }
    .icon-plus::before { content: "+"; }
    .icon-trash::before { content: "üóëÔ∏è"; }
    .icon-arrow-left::before { content: "‚Üê"; }
    .icon-check::before { content: "‚úì"; }
    .icon-x::before { content: "‚úï"; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const formatCurrency = (amount) => {
      return new Intl.NumberFormat('sv-SE', {
        style: 'currency',
        currency: 'SEK',
        minimumFractionDigits: 0,
        maximumFractionDigits: 0,
      }).format(amount);
    };

    // Simple icon components
    const Icon = ({ name, size = 20 }) => <span className={`icon-${name}`} style={{ fontSize: size }}></span>;

    const Monly = () => {
      const [view, setView] = useState('start');
      const [currentMonth, setCurrentMonth] = useState(null);
      const [selectedCategory, setSelectedCategory] = useState(null);
      const [isEditingProfile, setIsEditingProfile] = useState(false);
      
      const [accounts, setAccounts] = useState([]);
      const [currentAccountId, setCurrentAccountId] = useState(null);
      const [showAccountSwitcher, setShowAccountSwitcher] = useState(false);

      const currentAccount = accounts.find(acc => acc.id === currentAccountId);
      const months = currentAccount?.months || [];
      const profile = currentAccount?.profile || { name: '', occupation: '', notes: '' };
      const allExpenses = currentAccount?.allExpenses || { sparande: [], nojen: [], fasta: [] };

      useEffect(() => {
        const savedAccounts = localStorage.getItem('monly_accounts');
        const savedCurrentAccountId = localStorage.getItem('monly_current_account_id');
        
        if (savedAccounts) {
          const parsedAccounts = JSON.parse(savedAccounts);
          setAccounts(parsedAccounts);
          
          if (savedCurrentAccountId && parsedAccounts.find(acc => acc.id === savedCurrentAccountId)) {
            setCurrentAccountId(savedCurrentAccountId);
          } else if (parsedAccounts.length > 0) {
            setCurrentAccountId(parsedAccounts[0].id);
          }
        } else {
          const defaultAccount = {
            id: 'account_' + Date.now(),
            name: 'Privat konto',
            months: [],
            profile: { name: '', occupation: '', notes: '' },
            allExpenses: { sparande: [], nojen: [], fasta: [] }
          };
          setAccounts([defaultAccount]);
          setCurrentAccountId(defaultAccount.id);
        }
      }, []);

      useEffect(() => {
        if (accounts.length > 0) {
          localStorage.setItem('monly_accounts', JSON.stringify(accounts));
        }
      }, [accounts]);

      useEffect(() => {
        if (currentAccountId) {
          localStorage.setItem('monly_current_account_id', currentAccountId);
        }
      }, [currentAccountId]);

      const updateCurrentAccount = (updates) => {
        setAccounts(accounts.map(acc => 
          acc.id === currentAccountId ? { ...acc, ...updates } : acc
        ));
      };

      const setMonths = (newMonths) => {
        updateCurrentAccount({ months: newMonths });
      };

      const setProfile = (newProfile) => {
        updateCurrentAccount({ profile: newProfile });
      };

      const setAllExpenses = (newExpenses) => {
        updateCurrentAccount({ allExpenses: newExpenses });
      };

      const createNewMonth = () => {
        const now = new Date();
        const monthKey = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
        
        const existingMonth = months.find(m => m.monthKey === monthKey);
        if (existingMonth) {
          setCurrentMonth(existingMonth);
          setView('budget');
          return;
        }

        const previousMonth = months.length > 0 ? months[months.length - 1] : null;
        
        const newMonth = {
          monthKey,
          displayDate: now.toLocaleDateString('sv-SE', { month: 'long', year: 'numeric' }),
          income: 0,
          categories: {
            sparande: {
              name: 'Sparande',
              percentage: 20,
              budget: 0,
              items: previousMonth ? [...previousMonth.categories.sparande.items] : []
            },
            nojen: {
              name: 'N√∂jen',
              percentage: 30,
              budget: 0,
              items: previousMonth ? [...previousMonth.categories.nojen.items] : []
            },
            fasta: {
              name: 'Fasta kostnader',
              percentage: 50,
              budget: 0,
              items: previousMonth ? [...previousMonth.categories.fasta.items] : []
            }
          }
        };

        setCurrentMonth(newMonth);
        setView('budget');
      };

      const budgetMonth = (income) => {
        if (!income || income <= 0) return;

        const updatedMonth = {
          ...currentMonth,
          income: parseFloat(income),
          categories: {
            sparande: {
              ...currentMonth.categories.sparande,
              budget: parseFloat(income) * 0.2
            },
            nojen: {
              ...currentMonth.categories.nojen,
              budget: parseFloat(income) * 0.3
            },
            fasta: {
              ...currentMonth.categories.fasta,
              budget: parseFloat(income) * 0.5
            }
          }
        };

        setCurrentMonth(updatedMonth);
        
        const existingIndex = months.findIndex(m => m.monthKey === updatedMonth.monthKey);
        let updatedMonths;
        if (existingIndex >= 0) {
          updatedMonths = [...months];
          updatedMonths[existingIndex] = updatedMonth;
        } else {
          updatedMonths = [...months, updatedMonth];
        }
        setMonths(updatedMonths);
      };

      const addExpenseToCategory = (categoryKey, name, amount) => {
        if (!name || !amount || amount <= 0) return;

        const updatedMonth = { ...currentMonth };
        const newItem = {
          id: Date.now(),
          name,
          amount: parseFloat(amount)
        };
        
        updatedMonth.categories[categoryKey].items.push(newItem);
        setCurrentMonth(updatedMonth);

        const monthIndex = months.findIndex(m => m.monthKey === updatedMonth.monthKey);
        const updatedMonths = [...months];
        updatedMonths[monthIndex] = updatedMonth;
        setMonths(updatedMonths);

        const expenseExists = allExpenses[categoryKey].find(e => e.name === name);
        if (!expenseExists) {
          setAllExpenses({
            ...allExpenses,
            [categoryKey]: [...allExpenses[categoryKey], { name, amount: parseFloat(amount) }]
          });
        }
      };

      const updateExpenseInCategory = (categoryKey, itemId, name, amount) => {
        const updatedMonth = { ...currentMonth };
        const itemIndex = updatedMonth.categories[categoryKey].items.findIndex(i => i.id === itemId);
        
        if (itemIndex >= 0) {
          updatedMonth.categories[categoryKey].items[itemIndex] = {
            id: itemId,
            name,
            amount: parseFloat(amount)
          };
          
          setCurrentMonth(updatedMonth);

          const monthIndex = months.findIndex(m => m.monthKey === updatedMonth.monthKey);
          const updatedMonths = [...months];
          updatedMonths[monthIndex] = updatedMonth;
          setMonths(updatedMonths);
        }
      };

      const deleteExpenseFromCategory = (categoryKey, itemId) => {
        const updatedMonth = { ...currentMonth };
        updatedMonth.categories[categoryKey].items = updatedMonth.categories[categoryKey].items.filter(i => i.id !== itemId);
        
        setCurrentMonth(updatedMonth);

        const monthIndex = months.findIndex(m => m.monthKey === updatedMonth.monthKey);
        const updatedMonths = [...months];
        updatedMonths[monthIndex] = updatedMonth;
        setMonths(updatedMonths);
      };

      const calculateRemaining = (categoryKey) => {
        if (!currentMonth) return 0;
        const category = currentMonth.categories[categoryKey];
        const totalSpent = category.items.reduce((sum, item) => sum + item.amount, 0);
        return category.budget - totalSpent;
      };

      const deleteMonth = (monthKey) => {
        const updatedMonths = months.filter(m => m.monthKey !== monthKey);
        setMonths(updatedMonths);
        if (currentMonth && currentMonth.monthKey === monthKey) {
          setCurrentMonth(null);
        }
      };

      const updateProfileExpense = (categoryKey, oldName, newName, newAmount) => {
        const updatedExpenses = { ...allExpenses };
        const expenseIndex = updatedExpenses[categoryKey].findIndex(e => e.name === oldName);
        
        if (expenseIndex >= 0) {
          updatedExpenses[categoryKey][expenseIndex] = {
            name: newName,
            amount: parseFloat(newAmount)
          };
          setAllExpenses(updatedExpenses);

          const updatedMonths = months.map(month => {
            const updatedMonth = { ...month };
            const items = updatedMonth.categories[categoryKey].items.map(item => {
              if (item.name === oldName) {
                return { ...item, name: newName, amount: parseFloat(newAmount) };
              }
              return item;
            });
            updatedMonth.categories[categoryKey].items = items;
            return updatedMonth;
          });
          setMonths(updatedMonths);
        }
      };

      const deleteProfileExpense = (categoryKey, name) => {
        const updatedExpenses = { ...allExpenses };
        updatedExpenses[categoryKey] = updatedExpenses[categoryKey].filter(e => e.name !== name);
        setAllExpenses(updatedExpenses);

        const updatedMonths = months.map(month => {
          const updatedMonth = { ...month };
          updatedMonth.categories[categoryKey].items = updatedMonth.categories[categoryKey].items.filter(item => item.name !== name);
          return updatedMonth;
        });
        setMonths(updatedMonths);
      };

      const calculateTotals = () => {
        const totals = {
          totalIncome: 0,
          totalSaving: 0,
          totalExpenses: 0
        };

        months.forEach(month => {
          totals.totalIncome += month.income;
          
          Object.keys(month.categories).forEach(catKey => {
            const category = month.categories[catKey];
            const spent = category.items.reduce((sum, item) => sum + item.amount, 0);
            
            if (catKey === 'sparande') {
              totals.totalSaving += spent;
            } else {
              totals.totalExpenses += spent;
            }
          });
        });

        return totals;
      };

      const createNewAccount = (accountName) => {
        const newAccount = {
          id: 'account_' + Date.now(),
          name: accountName,
          months: [],
          profile: { name: '', occupation: '', notes: '' },
          allExpenses: { sparande: [], nojen: [], fasta: [] }
        };
        setAccounts([...accounts, newAccount]);
        setCurrentAccountId(newAccount.id);
        setView('start');
      };

      const switchAccount = (accountId) => {
        setCurrentAccountId(accountId);
        setCurrentMonth(null);
        setShowAccountSwitcher(false);
        setView('start');
      };

      const deleteAccount = (accountId) => {
        if (accounts.length <= 1) {
          alert('Du m√•ste ha minst ett konto');
          return;
        }
        const updatedAccounts = accounts.filter(acc => acc.id !== accountId);
        setAccounts(updatedAccounts);
        if (currentAccountId === accountId) {
          setCurrentAccountId(updatedAccounts[0].id);
          setCurrentMonth(null);
        }
      };

      const renameAccount = (accountId, newName) => {
        setAccounts(accounts.map(acc => 
          acc.id === accountId ? { ...acc, name: newName } : acc
        ));
      };

      function AccountSwitcher() {
        return (
          <div className="account-switcher-overlay" onClick={() => setShowAccountSwitcher(false)}>
            <div className="account-switcher" onClick={(e) => e.stopPropagation()}>
              <div className="switcher-header">
                <h3>Byt konto</h3>
                <button className="icon-button" onClick={() => setShowAccountSwitcher(false)}>
                  <Icon name="x" size={20} />
                </button>
              </div>
              <div className="accounts-list">
                {accounts.map(account => (
                  <div 
                    key={account.id}
                    className={`account-item ${account.id === currentAccountId ? 'active' : ''}`}
                    onClick={() => switchAccount(account.id)}
                  >
                    <span className="account-name">{account.name}</span>
                    {account.id === currentAccountId && (
                      <span className="active-badge">Aktiv</span>
                    )}
                  </div>
                ))}
              </div>
              <button 
                className="primary-button"
                onClick={() => {
                  setShowAccountSwitcher(false);
                  setView('accounts');
                }}
              >
                <Icon name="plus" size={20} />
                Hantera konton
              </button>
            </div>
          </div>
        );
      }

      function StartView() {
        return (
          <div className="start-view">
            <div className="logo-section">
              <h1 className="logo">Monly</h1>
              <p className="tagline">Enkel privatekonomi f√∂r alla</p>
            </div>

            {currentAccount && (
              <div className="current-account-badge" onClick={() => setShowAccountSwitcher(true)}>
                <span className="badge-label">Aktuellt konto</span>
                <span className="badge-name">{currentAccount.name}</span>
                <Icon name="edit" size={16} />
              </div>
            )}
            
            <button className="primary-button" onClick={createNewMonth}>
              <Icon name="calendar" size={20} />
              Budgetera ny m√•nad
            </button>

            <div className="quick-actions">
              {months.length > 0 && (
                <button className="secondary-button" onClick={() => {
                  setCurrentMonth(months[months.length - 1]);
                  setView('budget');
                }}>
                  Forts√§tt med senaste m√•naden
                </button>
              )}
            </div>
          </div>
        );
      }

      function BudgetView() {
        const [incomeInput, setIncomeInput] = useState(currentMonth.income || '');

        return (
          <div className="budget-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('start')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>{currentMonth.displayDate}</h2>
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="user" size={20} />
              </button>
            </div>

            {currentMonth.income === 0 ? (
              <div className="income-input-section">
                <label>Inkomst denna m√•nad</label>
                <input
                  type="number"
                  value={incomeInput}
                  onChange={(e) => setIncomeInput(e.target.value)}
                  placeholder="0"
                  className="income-input"
                />
                <button 
                  className="primary-button"
                  onClick={() => budgetMonth(incomeInput)}
                >
                  Budgetera
                </button>
              </div>
            ) : (
              <>
                <div className="income-display">
                  <span className="label">Inkomst</span>
                  <span className="amount">{formatCurrency(currentMonth.income)}</span>
                  <button 
                    className="edit-income-button"
                    onClick={() => {
                      const updatedMonth = { ...currentMonth, income: 0 };
                      setCurrentMonth(updatedMonth);
                    }}
                  >
                    <Icon name="edit" size={16} />
                    √Ñndra
                  </button>
                </div>

                <div className="categories-grid">
                  {Object.entries(currentMonth.categories).map(([key, category]) => {
                    const remaining = calculateRemaining(key);
                    const totalSpent = category.items.reduce((sum, item) => sum + item.amount, 0);
                    
                    return (
                      <div 
                        key={key} 
                        className={`category-card ${key}`}
                        onClick={() => {
                          setSelectedCategory({ key, ...category });
                          setView('category');
                        }}
                      >
                        <h3>{category.name}</h3>
                        <div className="percentage">{category.percentage}%</div>
                        <div className="budget-amount">{formatCurrency(category.budget)}</div>
                        <div className="spent-info">
                          <span className="spent-label">Anv√§nt:</span>
                          <span className="spent-amount">{formatCurrency(totalSpent)}</span>
                        </div>
                        <div className={`remaining ${remaining < 0 ? 'negative' : ''}`}>
                          <span className="remaining-label">Kvar:</span>
                          <span className="remaining-amount">{formatCurrency(remaining)}</span>
                        </div>
                      </div>
                    );
                  })}
                </div>
              </>
            )}
          </div>
        );
      }

      function CategoryView() {
        const [newExpenseName, setNewExpenseName] = useState('');
        const [newExpenseAmount, setNewExpenseAmount] = useState('');
        const [editingItem, setEditingItem] = useState(null);
        const [editName, setEditName] = useState('');
        const [editAmount, setEditAmount] = useState('');

        if (!selectedCategory) return null;

        const categoryKey = selectedCategory.key;
        const category = currentMonth.categories[categoryKey];
        const remaining = calculateRemaining(categoryKey);

        const handleAddExpense = () => {
          if (newExpenseName && newExpenseAmount) {
            addExpenseToCategory(categoryKey, newExpenseName, newExpenseAmount);
            setNewExpenseName('');
            setNewExpenseAmount('');
          }
        };

        const handleUpdateExpense = (itemId) => {
          if (editName && editAmount) {
            updateExpenseInCategory(categoryKey, itemId, editName, editAmount);
            setEditingItem(null);
            setEditName('');
            setEditAmount('');
          }
        };

        return (
          <div className="category-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => {
                setView('budget');
                setSelectedCategory(null);
              }}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>{category.name}</h2>
              <div></div>
            </div>

            <div className="category-summary">
              <div className="summary-item">
                <span className="label">Budget</span>
                <span className="value">{formatCurrency(category.budget)}</span>
              </div>
              <div className={`summary-item ${remaining < 0 ? 'negative' : ''}`}>
                <span className="label">Kvar</span>
                <span className="value">{formatCurrency(remaining)}</span>
              </div>
            </div>

            <div className="expenses-list">
              {category.items.map(item => (
                <div key={item.id} className="expense-item">
                  {editingItem === item.id ? (
                    <>
                      <input
                        type="text"
                        value={editName}
                        onChange={(e) => setEditName(e.target.value)}
                        className="expense-input"
                        placeholder="Namn"
                      />
                      <input
                        type="number"
                        value={editAmount}
                        onChange={(e) => setEditAmount(e.target.value)}
                        className="expense-input amount"
                        placeholder="Belopp"
                      />
                      <button
                        className="icon-button success"
                        onClick={() => handleUpdateExpense(item.id)}
                      >
                        <Icon name="check" size={18} />
                      </button>
                      <button
                        className="icon-button"
                        onClick={() => {
                          setEditingItem(null);
                          setEditName('');
                          setEditAmount('');
                        }}
                      >
                        <Icon name="x" size={18} />
                      </button>
                    </>
                  ) : (
                    <>
                      <span className="expense-name">{item.name}</span>
                      <span className="expense-amount">{formatCurrency(item.amount)}</span>
                      <button
                        className="icon-button"
                        onClick={() => {
                          setEditingItem(item.id);
                          setEditName(item.name);
                          setEditAmount(item.amount);
                        }}
                      >
                        <Icon name="edit" size={18} />
                      </button>
                      <button
                        className="icon-button danger"
                        onClick={() => deleteExpenseFromCategory(categoryKey, item.id)}
                      >
                        <Icon name="trash" size={18} />
                      </button>
                    </>
                  )}
                </div>
              ))}
            </div>

            <div className="add-expense">
              <h3>L√§gg till utgift</h3>
              <div className="add-expense-form">
                <input
                  type="text"
                  value={newExpenseName}
                  onChange={(e) => setNewExpenseName(e.target.value)}
                  placeholder="Namn"
                  className="expense-input"
                />
                <input
                  type="number"
                  value={newExpenseAmount}
                  onChange={(e) => setNewExpenseAmount(e.target.value)}
                  placeholder="Belopp"
                  className="expense-input amount"
                />
                <button
                  className="icon-button primary"
                  onClick={handleAddExpense}
                >
                  <Icon name="plus" size={20} />
                </button>
              </div>
            </div>
          </div>
        );
      }

      function ProfileView() {
        return (
          <div className="profile-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('budget')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Min profil</h2>
              <div></div>
            </div>

            <div className="profile-menu">
              <button className="menu-button" onClick={() => setView('accounts')}>
                <Icon name="user" size={20} />
                Konton
              </button>
              <button className="menu-button" onClick={() => setView('profileInfo')}>
                <Icon name="edit" size={20} />
                Profilinformation
              </button>
              <button className="menu-button" onClick={() => setView('history')}>
                <Icon name="calendar" size={20} />
                Historik
              </button>
              <button className="menu-button" onClick={() => setView('totalResult')}>
                <Icon name="trending" size={20} />
                Totalt resultat
              </button>
              <button className="menu-button" onClick={() => setView('editExpenses')}>
                <Icon name="edit" size={20} />
                Redigera utgifter
              </button>
            </div>
          </div>
        );
      }

      function AccountsView() {
        const [isCreating, setIsCreating] = useState(false);
        const [newAccountName, setNewAccountName] = useState('');
        const [editingAccount, setEditingAccount] = useState(null);
        const [editName, setEditName] = useState('');

        const handleCreateAccount = () => {
          if (newAccountName.trim()) {
            createNewAccount(newAccountName.trim());
            setIsCreating(false);
            setNewAccountName('');
          }
        };

        const handleRenameAccount = (accountId) => {
          if (editName.trim()) {
            renameAccount(accountId, editName.trim());
            setEditingAccount(null);
            setEditName('');
          }
        };

        return (
          <div className="accounts-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Konton</h2>
              <div></div>
            </div>

            <div className="accounts-list-full">
              {accounts.map(account => (
                <div key={account.id} className="account-card">
                  {editingAccount === account.id ? (
                    <div className="account-edit-form">
                      <input
                        type="text"
                        value={editName}
                        onChange={(e) => setEditName(e.target.value)}
                        className="account-name-input"
                        placeholder="Kontonamn"
                      />
                      <div className="edit-actions">
                        <button
                          className="icon-button success"
                          onClick={() => handleRenameAccount(account.id)}
                        >
                          <Icon name="check" size={18} />
                        </button>
                        <button
                          className="icon-button"
                          onClick={() => {
                            setEditingAccount(null);
                            setEditName('');
                          }}
                        >
                          <Icon name="x" size={18} />
                        </button>
                      </div>
                    </div>
                  ) : (
                    <>
                      <div className="account-info">
                        <h3>
                          {account.name}
                          {account.id === currentAccountId && (
                            <span className="current-badge">Aktiv</span>
                          )}
                        </h3>
                        <p className="account-stats">
                          {account.months.length} {account.months.length === 1 ? 'm√•nad' : 'm√•nader'}
                        </p>
                      </div>
                      <div className="account-actions">
                        {account.id !== currentAccountId && (
                          <button
                            className="secondary-button small"
                            onClick={() => switchAccount(account.id)}
                          >
                            Byt till
                          </button>
                        )}
                        <button
                          className="icon-button"
                          onClick={() => {
                            setEditingAccount(account.id);
                            setEditName(account.name);
                          }}
                        >
                          <Icon name="edit" size={18} />
                        </button>
                        {accounts.length > 1 && (
                          <button
                            className="icon-button danger"
                            onClick={() => {
                              if (confirm(`√Ñr du s√§ker p√• att du vill ta bort kontot "${account.name}"? All data kommer att raderas.`)) {
                                deleteAccount(account.id);
                              }
                            }}
                          >
                            <Icon name="trash" size={18} />
                          </button>
                        )}
                      </div>
                    </>
                  )}
                </div>
              ))}
            </div>

            {isCreating ? (
              <div className="create-account-form">
                <input
                  type="text"
                  value={newAccountName}
                  onChange={(e) => setNewAccountName(e.target.value)}
                  placeholder="Namn p√• nytt konto (t.ex. F√∂retag)"
                  className="account-name-input"
                  autoFocus
                />
                <div className="create-actions">
                  <button
                    className="primary-button"
                    onClick={handleCreateAccount}
                  >
                    <Icon name="check" size={18} />
                    Skapa konto
                  </button>
                  <button
                    className="secondary-button"
                    onClick={() => {
                      setIsCreating(false);
                      setNewAccountName('');
                    }}
                  >
                    Avbryt
                  </button>
                </div>
              </div>
            ) : (
              <button
                className="add-account-button"
                onClick={() => setIsCreating(true)}
              >
                <Icon name="plus" size={20} />
                L√§gg till nytt konto
              </button>
            )}
          </div>
        );
      }

      function ProfileInfoView() {
        const [tempProfile, setTempProfile] = useState(profile);

        return (
          <div className="profile-info-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Profilinformation</h2>
              <div></div>
            </div>

            <div className="profile-form">
              <div className="form-group">
                <label>Namn</label>
                <input
                  type="text"
                  value={tempProfile.name}
                  onChange={(e) => setTempProfile({ ...tempProfile, name: e.target.value })}
                  disabled={!isEditingProfile}
                  className="form-input"
                />
              </div>
              <div className="form-group">
                <label>Yrke</label>
                <input
                  type="text"
                  value={tempProfile.occupation}
                  onChange={(e) => setTempProfile({ ...tempProfile, occupation: e.target.value })}
                  disabled={!isEditingProfile}
                  className="form-input"
                />
              </div>
              <div className="form-group">
                <label>Anteckningar</label>
                <textarea
                  value={tempProfile.notes}
                  onChange={(e) => setTempProfile({ ...tempProfile, notes: e.target.value })}
                  disabled={!isEditingProfile}
                  className="form-textarea"
                  rows={4}
                />
              </div>

              <button
                className="primary-button"
                onClick={() => {
                  if (isEditingProfile) {
                    setProfile(tempProfile);
                    setIsEditingProfile(false);
                  } else {
                    setIsEditingProfile(true);
                  }
                }}
              >
                {isEditingProfile ? 'Spara profil' : 'Redigera profil'}
              </button>
            </div>
          </div>
        );
      }

      function HistoryView() {
        return (
          <div className="history-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Historik</h2>
              <div></div>
            </div>

            {months.length === 0 ? (
              <div className="empty-state">
                <p>Ingen historik √§nnu</p>
              </div>
            ) : (
              <div className="history-list">
                {months.slice().reverse().map(month => (
                  <div key={month.monthKey} className="history-item">
                    <div className="history-info">
                      <h3>{month.displayDate}</h3>
                      <p className="history-income">{formatCurrency(month.income)}</p>
                    </div>
                    <div className="history-actions">
                      <button
                        className="icon-button"
                        onClick={() => {
                          setCurrentMonth(month);
                          setView('budget');
                        }}
                      >
                        <Icon name="edit" size={18} />
                      </button>
                      <button
                        className="icon-button danger"
                        onClick={() => deleteMonth(month.monthKey)}
                      >
                        <Icon name="trash" size={18} />
                      </button>
                    </div>
                  </div>
                ))}
              </div>
            )}
          </div>
        );
      }

      function TotalResultView() {
        const totals = calculateTotals();

        return (
          <div className="total-result-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Totalt resultat</h2>
              <div></div>
            </div>

            <div className="totals-summary">
              <div className="total-card income">
                <h3>Total inkomst</h3>
                <p className="total-amount">{formatCurrency(totals.totalIncome)}</p>
              </div>
              <div className="total-card saving">
                <h3>Totalt sparande</h3>
                <p className="total-amount">{formatCurrency(totals.totalSaving)}</p>
              </div>
              <div className="total-card expenses">
                <h3>Totala utgifter</h3>
                <p className="total-amount">{formatCurrency(totals.totalExpenses)}</p>
              </div>
              <div className="total-card net">
                <h3>Nettof√∂rm√∂genhet</h3>
                <p className="total-amount">{formatCurrency(totals.totalSaving)}</p>
              </div>
            </div>

            <div className="months-overview">
              <h3>Per m√•nad</h3>
              {months.slice().reverse().map(month => {
                let totalSaving = 0;
                let totalExpenses = 0;

                Object.keys(month.categories).forEach(catKey => {
                  const spent = month.categories[catKey].items.reduce((sum, item) => sum + item.amount, 0);
                  if (catKey === 'sparande') {
                    totalSaving += spent;
                  } else {
                    totalExpenses += spent;
                  }
                });

                return (
                  <div key={month.monthKey} className="month-summary">
                    <h4>{month.displayDate}</h4>
                    <div className="month-stats">
                      <div className="stat">
                        <span className="label">Inkomst:</span>
                        <span>{formatCurrency(month.income)}</span>
                      </div>
                      <div className="stat">
                        <span className="label">Sparat:</span>
                        <span>{formatCurrency(totalSaving)}</span>
                      </div>
                      <div className="stat">
                        <span className="label">Utgifter:</span>
                        <span>{formatCurrency(totalExpenses)}</span>
                      </div>
                    </div>
                  </div>
                );
              })}
            </div>
          </div>
        );
      }

      function EditExpensesView() {
        const [editingExpense, setEditingExpense] = useState(null);
        const [editName, setEditName] = useState('');
        const [editAmount, setEditAmount] = useState('');
        const [addingToCategory, setAddingToCategory] = useState(null);
        const [newName, setNewName] = useState('');
        const [newAmount, setNewAmount] = useState('');

        const handleAddNewExpense = (categoryKey) => {
          if (newName && newAmount && parseFloat(newAmount) > 0) {
            const updatedExpenses = { ...allExpenses };
            updatedExpenses[categoryKey].push({
              name: newName,
              amount: parseFloat(newAmount)
            });
            setAllExpenses(updatedExpenses);
            setAddingToCategory(null);
            setNewName('');
            setNewAmount('');
          }
        };

        return (
          <div className="edit-expenses-view">
            <div className="view-header">
              <button className="icon-button" onClick={() => setView('profile')}>
                <Icon name="arrow-left" size={20} />
              </button>
              <h2>Redigera utgifter</h2>
              <div></div>
            </div>

            {Object.entries(allExpenses).map(([categoryKey, expenses]) => {
              const categoryNames = {
                sparande: 'Sparande',
                nojen: 'N√∂jen',
                fasta: 'Fasta kostnader'
              };

              return (
                <div key={categoryKey} className="expense-category-section">
                  <h3>{categoryNames[categoryKey]}</h3>
                  {expenses.length === 0 && addingToCategory !== categoryKey ? (
                    <p className="empty-text">Inga utgifter √§nnu</p>
                  ) : (
                    <div className="expenses-list">
                      {expenses.map((expense, index) => (
                        <div key={index} className="expense-item">
                          {editingExpense === `${categoryKey}-${expense.name}` ? (
                            <>
                              <input
                                type="text"
                                value={editName}
                                onChange={(e) => setEditName(e.target.value)}
                                className="expense-input"
                              />
                              <input
                                type="number"
                                value={editAmount}
                                onChange={(e) => setEditAmount(e.target.value)}
                                className="expense-input amount"
                              />
                              <button
                                className="icon-button success"
                                onClick={() => {
                                  updateProfileExpense(categoryKey, expense.name, editName, editAmount);
                                  setEditingExpense(null);
                                }}
                              >
                                <Icon name="check" size={18} />
                              </button>
                              <button
                                className="icon-button"
                                onClick={() => setEditingExpense(null)}
                              >
                                <Icon name="x" size={18} />
                              </button>
                            </>
                          ) : (
                            <>
                              <span className="expense-name">{expense.name}</span>
                              <span className="expense-amount">{formatCurrency(expense.amount)}</span>
                              <button
                                className="icon-button"
                                onClick={() => {
                                  setEditingExpense(`${categoryKey}-${expense.name}`);
                                  setEditName(expense.name);
                                  setEditAmount(expense.amount);
                                }}
                              >
                                <Icon name="edit" size={18} />
                              </button>
                              <button
                                className="icon-button danger"
                                onClick={() => deleteProfileExpense(categoryKey, expense.name)}
                              >
                                <Icon name="trash" size={18} />
                              </button>
                            </>
                          )}
                        </div>
                      ))}
                      
                      {addingToCategory === categoryKey && (
                        <div className="expense-item">
                          <input
                            type="text"
                            value={newName}
                            onChange={(e) => setNewName(e.target.value)}
                            placeholder="Namn"
                            className="expense-input"
                          />
                          <input
                            type="number"
                            value={newAmount}
                            onChange={(e) => setNewAmount(e.target.value)}
                            placeholder="Belopp"
                            className="expense-input amount"
                          />
                          <button
                            className="icon-button success"
                            onClick={() => handleAddNewExpense(categoryKey)}
                          >
                            <Icon name="check" size={18} />
                          </button>
                          <button
                            className="icon-button"
                            onClick={() => {
                              setAddingToCategory(null);
                              setNewName('');
                              setNewAmount('');
                            }}
                          >
                            <Icon name="x" size={18} />
                          </button>
                        </div>
                      )}
                    </div>
                  )}
                  
                  {addingToCategory !== categoryKey && (
                    <button
                      className="add-expense-button"
                      onClick={() => setAddingToCategory(categoryKey)}
                    >
                      <Icon name="plus" size={18} />
                      L√§gg till utgift
                    </button>
                  )}
                </div>
              );
            })}
          </div>
        );
      }

      return (
        <div className="monly-app">
          {view === 'start' && <StartView />}
          {view === 'budget' && <BudgetView />}
          {view === 'category' && <CategoryView />}
          {view === 'profile' && <ProfileView />}
          {view === 'accounts' && <AccountsView />}
          {view === 'profileInfo' && <ProfileInfoView />}
          {view === 'history' && <HistoryView />}
          {view === 'totalResult' && <TotalResultView />}
          {view === 'editExpenses' && <EditExpensesView />}
          {showAccountSwitcher && <AccountSwitcher />}
        </div>
      );
    };

    ReactDOM.render(<Monly />, document.getElementById('root'));
  </script>
</body>
</html>
